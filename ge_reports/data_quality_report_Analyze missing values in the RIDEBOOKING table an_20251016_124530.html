<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>RIDEBOOKING — BOOKING_VALUE Data Quality Report</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{font-family:Arial,Helvetica,sans-serif;color:#0b2033}
    body{margin:0;padding:20px;background:#f7f9fb}
    header{background:#ffffff;padding:18px 24px;border-radius:8px;border:1px solid #e1e6ea}
    h1{margin:0;font-size:20px;color:#052034}
    p.meta{margin:6px 0 0;color:#475569;font-size:13px}
    nav.tabs{margin-top:14px;display:flex;gap:8px}
    nav a.tab{display:inline-block;padding:10px 14px;border-radius:6px;text-decoration:none;background:#e9f0f6;color:#044b77;border:1px solid transparent;font-weight:600}
    nav a.tab[aria-current="true"]{background:#044b77;color:#ffffff;border-color:#044b77}
    main{margin-top:18px}
    section.card{background:#ffffff;padding:18px;border-radius:8px;border:1px solid #e1e6ea;margin-bottom:14px}
    section.card h2{margin-top:0;font-size:16px;color:#052034}
    .muted{color:#5b6b77;font-size:13px}
    ul.issue-list{padding-left:18px}
    table.kpis{width:100%;border-collapse:collapse;margin-top:8px}
    table.kpis th, table.kpis td{border:1px solid #e6eef5;padding:8px;text-align:left;font-size:13px}
    table.kpis th{background:#f1f7fb;font-weight:700}
    .btn{display:inline-block;padding:10px 14px;background:#0373b9;color:#fff;text-decoration:none;border-radius:6px;border:1px solid #0363a6;font-weight:700}
    .placeholder{padding:18px;border:1px dashed #cfdde8;border-radius:6px;background:#fbfeff;color:#4b6676}
    footer{margin-top:18px;font-size:13px;color:#5b6b77}
    .small{font-size:13px;color:#5b6b77}
  </style>
</head>
<body>
  <header>
    <h1>RIDEBOOKING — BOOKING_VALUE Data Quality Report</h1>
    <p class="meta">Date: 2025-10-16 &nbsp;|&nbsp; Dataset sample profiled: 100,000 rows</p>
    <nav class="tabs" aria-label="Report navigation">
      <a class="tab" href="#overview" aria-current="true">Overview Report</a>
      <a class="tab" href="./RIDEBOOKING_profile_20251016_123722.html">Detailed Profiling</a>
    </nav>
  </header>

  <main>
    <section id="executive-summary" class="card">
      <h2>Executive Summary</h2>
      <p class="muted">This report summarizes the data-quality findings from a profiling run over a 100k-row sample of the RIDEBOOKING table (profiling artifacts: JSON and HTML). The profiling targeted the BOOKING_VALUE field and produced a derived numeric column BOOKING_VALUE_NUM via TRY_CAST. The sample shows multiple data-quality problems that impact analytics and downstream processing, including non-numeric tokens that prevent numeric casting, a material rate of missing/uncastable fares, extreme outliers, and zero/negative fares. The scan used a LIMIT 100,000 sample; full-table impact must be quantified before schema changes.</p>

      <p class="small"><strong>Profiling artifacts:</strong>
        <ul class="small" style="margin:6px 0 0;padding-left:18px">
          <li>HTML report: <a href="./RIDEBOOKING_profile_20251016_123722.html">RIDEBOOKING_profile_20251016_123722.html</a></li>
          <li>JSON report: ge_reports/RIDEBOOKING_profile_20251016_123727.json</li>
        </ul>
      </p>
    </section>

    <section id="data-profile-overview" class="card">
      <h2>Data Profile Overview</h2>
      <p class="muted">Source: RIDEBOOKING table — profiling executed against a 100k-row sample. The profiling focused on BOOKING_VALUE and produced BOOKING_VALUE_NUM using TRY_CAST on the raw string column.</p>

      <dl>
        <dt><strong>Sample size</strong></dt>
        <dd class="small">100,000 rows (LIMIT 100000 applied during profiling run)</dd>

        <dt style="margin-top:8px"><strong>Columns of interest</strong></dt>
        <dd class="small">BOOKING_VALUE (raw), BOOKING_VALUE_NUM (derived via TRY_CAST)</dd>

        <dt style="margin-top:8px"><strong>Profiling artifacts</strong></dt>
        <dd class="small">HTML: ./RIDEBOOKING_profile_20251016_123722.html | JSON: ge_reports/RIDEBOOKING_profile_20251016_123727.json</dd>
      </dl>
    </section>

    <section id="data-quality-assessment" class="card">
      <h2>Data Quality Assessment</h2>
      <p class="muted">The profiling run identified the following issues in the 100k sample. Severity tags indicate relative priority based on impact to analytics and finance processes.</p>

      <ol class="issue-list">
        <li><strong>[High] Missing Values (BOOKING_VALUE)</strong>
          <p class="small">The derived BOOKING_VALUE_NUM column reported non-zero missing/null counts in the sample (per JSON report). This reflects either SQL NULLs or literal string tokens (e.g., 'null') in the raw BOOKING_VALUE column that prevented casting.</p>
        </li>

        <li><strong>[High] Type Mismatch / Non-numeric tokens</strong>
          <p class="small">TRY_CAST returned NULL for some non-null BOOKING_VALUE entries. The sample indicates presence of non-numeric patterns (literal 'null', currency symbols, thousands separators, alphabetic text, or malformed formatting) that block numeric conversion.</p>
        </li>

        <li><strong>[Medium] Outliers / Extreme Values</strong>
          <p class="small">The profiling flagged extreme fare values in the 100k sample. These can bias aggregates and may indicate fraud, multi-ride charges, currency/scale errors, or parsing mistakes.</p>
        </li>

        <li><strong>[Medium] Zero or Negative Fare Values</strong>
          <p class="small">Zero and negative fares were observed in the sample. These may be legitimate (refunds/promotions) or indicate data entry/processing errors and require business validation.</p>
        </li>

        <li><strong>[Low] Sampling / Coverage Limitation</strong>
          <p class="small">The profile used LIMIT 100k. If the table is larger or not randomly ordered, the sample may not represent full-table distributions. Full-table or stratified sampling is required to quantify total impact.</p>
        </li>

        <li><strong>[Low] Missing cross-field validation</strong>
          <p class="small">This profiling focused on BOOKING_VALUE only. Cross-field checks (BOOKING_STATUS, PAYMENT_METHOD) were not performed but are important to identify root causes (e.g., cancellations, wallet reconciliations, or ingestion transformations).</p>
        </li>
      </ol>
    </section>

    <section id="kpis-and-trends" class="card">
      <h2>Key KPIs and Trends</h2>
      <p class="muted">Below are the primary KPIs to track for BOOKING_VALUE quality (profiling sample indicates issues; exact counts and rates are available in the JSON report referenced above). These KPIs should be measured on full-table runs and trended.</p>

      <table class="kpis" aria-describedby="kpi-desc">
        <thead>
          <tr><th>KPI</th><th>Rationale / Observed behavior in sample</th></tr>
        </thead>
        <tbody>
          <tr><td>Missing / NULL rate (BOOKING_VALUE and BOOKING_VALUE_NUM)</td><td>Sample reported non-zero missing/uncastable counts. Quantify full-table impact.</td></tr>
          <tr><td>Cast-failure rate (TRY_CAST -> NULL)</td><td>Indicates prevalence of non-numeric tokens (literal 'null', symbols, separators).</td></tr>
          <tr><td>Rate of zero or negative fares</td><td>Observed in sample; verify business legitimacy vs. data errors.</td></tr>
          <tr><td>Outlier counts (top-n and >99th percentile)</td><td>Profiling flagged extreme values; necessary to inspect and reconcile.</td></tr>
          <tr><td>Profiling coverage</td><td>Sample size used: 100k. Increase to full-table or stratified sampling to ensure representativeness.</td></tr>
        </tbody>
      </table>

      <p id="kpi-desc" class="small">Note: For exact numeric KPI values and distribution charts, see the detailed profiling HTML/JSON artifact linked in the Detailed Profiling tab.</p>
    </section>

    <section id="visualizations" class="card">
      <h2>Visualizations</h2>
      <p class="muted">The profiling run generated distribution and outlier detection visuals in the detailed HTML report. No standalone image assets were provided with this summary; use the Detailed Profiling HTML to view full plots and histograms.</p>

      <div class="placeholder" role="img" aria-label="Placeholder for distribution histogram">
        Distribution histogram and outlier plots: see <a href="./RIDEBOOKING_profile_20251016_123722.html">Detailed Profiling</a>
      </div>
    </section>

    <section id="recommendations" class="card">
      <h2>Recommendations (Actionable)</h2>
      <p class="muted">Recommendations are prioritized to quantify scope, remediate data, and prevent recurrence.</p>

      <ol>
        <li><strong>Priority 1 — Full quantification</strong>
          <p class="small">Run full-table counts for total rows, literal 'null' occurrences, and TRY_CAST failures for BOOKING_VALUE to quantify scope before changing schema or producing aggregates.</p>
        </li>

        <li><strong>Priority 2 — Clean and persist a numeric fare column</strong>
          <p class="small">Implement deterministic cleaning (trim, remove currency symbols and thousands separators, normalize tokens like 'null' -> SQL NULL) and persist BOOKING_VALUE_NUM populated via TRY_CAST on cleaned strings. Retain original BOOKING_VALUE_RAW for audit.</p>
        </li>

        <li><strong>Priority 3 — Ingestion validation & error routing</strong>
          <p class="small">At ingestion, validate BOOKING_VALUE format and numeric range; route invalid rows to an error table with reason codes ('non-numeric', 'literal_null', 'empty') for remediation and alerting.</p>
        </li>

        <li><strong>Priority 4 — Remediation policy for missing values</strong>
          <p class="small">For analytics, consider imputing missing fares (e.g., median by VEHICLE_TYPE and DATE/HOUR) and mark imputed rows. For financial/audit use-cases, do not impute—escalate to payment/source-of-record for reconciliation.</p>
        </li>

        <li><strong>Priority 5 — Investigate outliers and negative/zero fares</strong>
          <p class="small">Produce top-N lists of largest and non-positive fares for manual review and reconcile against payment logs; apply business rules (manual review, caps, or rejection) when appropriate.</p>
        </li>

        <li><strong>Priority 6 — Increase profiling coverage and cadence</strong>
          <p class="small">Remove the single LIMIT 100k sampling or implement stratified/rolling samples across time/vehicle types; store JSON/HTML profiling artifacts and track trends for missing rate, cast-failure rate, and 99th percentile.</p>
        </li>

        <li><strong>Priority 7 — Gradual schema hardening and monitoring</strong>
          <p class="small">After cleaning and upstream fixes, consider enforcing numeric type for BOOKING_VALUE_NUM and adding NOT NULL only when safe. Implement dashboards/alerts for DQ metrics and monitor regressions.</p>
        </li>

        <li><strong>Priority 8 — Cross-system reconciliation</strong>
          <p class="small">Cross-validate problematic records against BOOKING_STATUS, PAYMENT_METHOD, and external payment/reconciliation logs to identify systemic sources of bad or missing BOOKING_VALUE values.</p>
        </li>
      </ol>
    </section>

    <section id="profiling-link" class="card">
      <h2>Link to Detailed Profiling Report</h2>
      <p class="muted">Open the full profiling HTML artifact for distribution histograms, outlier tables, and the complete JSON metrics captured during the sample run.</p>
      <p><a class="btn" href="./RIDEBOOKING_profile_20251016_123722.html">Open Detailed Profiling Report</a></p>
      <p class="small">JSON artifact (sample metrics): ge_reports/RIDEBOOKING_profile_20251016_123727.json</p>
    </section>
  </main>

  <footer>
    <div class="small">Report generated by Data Profiling & Analytics pipeline — profiling sample: 100,000 rows. This summary uses only the information provided in the profiling artifacts. For full validation, run the recommended full-table quantification and remediation steps.</div>
  </footer>
</body>
</html>